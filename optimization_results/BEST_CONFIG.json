{
  "summary": {
    "best_overall_experiment": "exp3_max_seq_balanced",
    "best_overall_accuracy": 99.49,
    "november_baseline": 98.01,
    "december_initial": 98.94,
    "improvement_over_november": "+1.48%",
    "improvement_over_december": "+0.55%",
    "total_experiments_run": 24,
    "experiments_this_session": 9
  },
  "best_overall": {
    "experiment": "exp3_max_seq_balanced",
    "test_accuracy": 99.49,
    "per_class": {
      "K1": 99.5, "K3": 97.6, "K4": 98.1, "K5": 99.7, "K7": 100.0,
      "K10": 98.1, "K12": 96.2, "K13": 100.0, "K14": 83.3,
      "K17": 100.0, "K21": 93.9, "K27": 100.0, "noise": 99.9
    },
    "config": {
      "backbone": "resnet18",
      "pretrained": false,
      "batch_size": 64,
      "lr": 0.0003,
      "weight_decay": 0.0001,
      "max_epochs": 100,
      "early_stop_patience": 25,
      "sr": 44100,
      "sequence_len": 1000,
      "n_fft": 1024,
      "hop_length": 172,
      "n_freq_bins": 256,
      "fmin": 500,
      "fmax": 10000,
      "freq_compression": "linear",
      "loss_type": "label_smoothing",
      "label_smoothing": 0.1,
      "weighted_sampling": true,
      "sampling_strategy": "sqrt_inverse_freq",
      "k12_k14_boost": 1.5,
      "use_compile": true,
      "scheduler": "onecycle",
      "grad_clip": 1.0
    },
    "training_time_minutes": 11.2
  },
  "k12_k14_optimization_experiments": {
    "exp1_long_seq_label_smooth": {
      "test_accuracy": 99.10,
      "k12": 92.4,
      "k14": 75.0,
      "best_k14_during_training": 91.7,
      "key_config": "800ms sequence, 1.5x K12/K14 boost"
    },
    "exp2_aggressive_k12_k14": {
      "test_accuracy": 98.78,
      "k12": 87.3,
      "k14": 75.0,
      "best_k14_during_training": 100.0,
      "key_config": "inverse_freq sampling, 2x/3x class weights"
    },
    "exp3_max_seq_balanced": {
      "test_accuracy": 99.49,
      "k12": 96.2,
      "k14": 83.3,
      "best_k14_during_training": 91.7,
      "status": "BEST OVERALL - CHAMPION",
      "key_config": "1000ms sequence, 1.5x boost"
    },
    "exp4_resnet34_long_seq": {
      "test_accuracy": 99.00,
      "k12": 93.7,
      "k14": 58.3,
      "best_k14_during_training": 100.0,
      "key_config": "ResNet34 with 800ms sequence"
    },
    "exp5_k14_extreme_focus": {
      "test_accuracy": 99.04,
      "k12": 92.4,
      "k14": 66.7,
      "best_k14_during_training": 100.0,
      "key_config": "3x sampling boost, 4x K14 loss weight"
    },
    "exp6_convnext_ultimate": {
      "test_accuracy": 99.20,
      "k12": 89.9,
      "k14": 75.0,
      "best_k14_during_training": 100.0,
      "key_config": "ConvNeXt tiny, 1000ms, all optimizations"
    },
    "exp7_resnet18_1200ms": {
      "test_accuracy": 99.23,
      "k12": 92.4,
      "k14": 83.3,
      "key_config": "1200ms sequence - longer sequences test"
    },
    "exp8_resnet18_1500ms": {
      "test_accuracy": 99.16,
      "k12": 92.4,
      "k14": 75.0,
      "key_config": "1500ms sequence - maximum length test"
    },
    "exp9_convnext_1200ms_bs64": {
      "test_accuracy": 99.04,
      "k12": 84.8,
      "k14": 83.3,
      "key_config": "ConvNeXt 1200ms with batch_size=64"
    }
  },
  "architecture_comparison": {
    "resnet18": {
      "best_accuracy": 99.49,
      "best_k12": 96.2,
      "best_k14": 83.3,
      "training_speed": "fastest (~15-21 it/s)",
      "verdict": "BEST OVERALL - Recommended for production"
    },
    "resnet34": {
      "best_accuracy": 99.00,
      "best_k12": 93.7,
      "best_k14": 58.3,
      "training_speed": "slower than ResNet18",
      "verdict": "Larger model hurt K14 - not recommended"
    },
    "convnext_tiny": {
      "best_accuracy": 99.20,
      "best_k12": 89.9,
      "best_k14": 83.3,
      "training_speed": "slower (~10-15 it/s)",
      "verdict": "Similar K14 but lower overall - not recommended"
    }
  },
  "sequence_length_analysis": {
    "800ms": {"accuracy": 99.10, "k12": 92.4, "k14": 75.0},
    "1000ms": {"accuracy": 99.49, "k12": 96.2, "k14": 83.3, "status": "OPTIMAL"},
    "1200ms": {"accuracy": 99.23, "k12": 92.4, "k14": 83.3},
    "1500ms": {"accuracy": 99.16, "k12": 92.4, "k14": 75.0},
    "conclusion": "1000ms is optimal - longer sequences provide no benefit"
  },
  "key_findings": [
    "99.49% accuracy achieved - NEW BEST, surpasses all baselines by 1.48%",
    "1000ms sequence length is optimal - longer sequences (1200ms, 1500ms) did NOT improve results",
    "K12 improved: 85.5% (Nov) -> 96.2% (+10.7%)",
    "K14 improved: 62.5% (Nov) -> 83.3% (+20.8%)",
    "Label smoothing (0.1) consistently best loss function",
    "sqrt_inverse_freq sampling with 1.5x K12/K14 boost optimal",
    "ResNet18 outperforms ResNet34 and ConvNeXt for cetacean spectrograms",
    "Aggressive weighting strategies hurt performance - moderate (1.5x) is best",
    "OneCycle scheduler outperforms plateau-based schedulers",
    "torch.compile() provides 2-3x speedup on RTX 5090",
    "SpecAugment causes training instability - AVOID",
    "batch_size=64 optimal for both ResNet18 and ConvNeXt"
  ],
  "what_didnt_work": [
    "Focal loss - caused noise class collapse (27-44%)",
    "MixUp augmentation - catastrophic on spectrograms",
    "SpecAugment - training instability",
    "Aggressive class weighting (3x+) - hurt overall accuracy",
    "inverse_freq sampling - too aggressive, sqrt_inverse_freq better",
    "Longer sequences (1200ms, 1500ms) - no improvement over 1000ms",
    "ResNet34 - larger model did not help, hurt K14",
    "ImageNet pretraining - scratch training better for spectrograms"
  ],
  "november_baselines": {
    "resnet18": {"accuracy": 91.95, "note": "Original baseline"},
    "convnext_pretrained": {"accuracy": 96.91, "note": "ImageNet pretraining"},
    "convnext_stable": {"accuracy": 98.01, "note": "Best November result"}
  },
  "training_environment": {
    "gpu": "NVIDIA RTX 5090 (24GB VRAM)",
    "training_speed": "~15-21 it/s",
    "average_training_time": "11-23 minutes per experiment"
  },
  "date": "2025-12-23"
}
